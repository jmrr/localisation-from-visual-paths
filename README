This is a Matlab code to extract visual descriptors and implement a bag of
visual words pipeline from video sequences.
The code is customised and ready to be used with the RSM dataset 
(http://rsm.bicv.org) but can be used on any sort of image sequences if the
directory paths are correctly specified.

Current implemented descriptor extraction methods (description below):
LW_COLOR, SIFT, DSIFT, SF_GABOR, ST_GABOR, ST_GAUSS

Current supported format of the sequences: JPG

Authors: Jose Rivera (jose.rivera@imperial.ac.uk)
         Ioannis Alexiou (i.alexiou@qmul.ac.uk)
         Anil A. Bharath (a.bharath@imperial.ac.uk)

Web: http://www.bicv.org

Date: v2.0 05/2014

Requirements:
============

SIFT, DSIFT, VLAD and kernel implementations require VLFEAT (http://www.vlfeat.org/)
Clustering requires INRIA's Yael K-means (https://gforge.inria.fr/projects/yael/)

Running Instructions:
====================

Descriptor generation
---------------------

1. Run main.m selecting the following parameters before running the loop:

DATASET_DIR: The root path of the RSM dataset
CORRIDORS: Corridors to run [1:6]
PASSES: Passes to run [1:10]
FRAME_FOLDER: Folder name where all the frames have been extracted.
DESCRIPTOR_DESTINATION_FOLDER
DESCRIPTOR: Type of descriptors to be calculated. To choose from
    - LW_COLOR: Lightweight spatio-temporal colour descriptor
    - SIFT: keypoint based SIFT descriptors
    - DSIFT: Dense SIFT
    - SF_GABOR: Frame-based DAISY-like descriptors
    - ST_GABOR: Spatio-temporal Gabors.
    - ST_GAUSS: Spatio-temporal, Spatial Derivative, Temporal Gaussian

Bag of Words pipeline
---------------------

2. create_dictionaries (k-means vector quantization)
    -> cluster_descriptors
    OR
    -> cluster_descriptors_sparse (for Keypoint-SIFT)

3. hovw_encoding (Hard assigment, VLAD, or LLC)
    -> hovw_encoding
       Modify the parameters of the encoding, which will automatically call
       encode_hovw_METHOD/encode_hovw_METHOD_sparse (for Keypoint-SIFT),
       where METHOD = 
        HA, "Visual categorization with bags of keypoints", Dance et al., 2004,
        VLAD, "Aggregating local descriptors into a compact image representation", Jegou et al., 2010,
        LLC, "Locality-constrained Linear Coding for Image Classification", Wang et al., 2010.

4. Kernels for histograms
    -> run_kernel_HA
    -> run_kernel_Hellinger

5. Run evaluation routine to add the error measurement to the kernels.
    -> run_evaluation_nn_VW
        -> Modify feature type and paths.
        -> evaluation_nn_VW

[6]. [Optional: Move kernels to one folder]
    -> cd /folder/to/kernels
    -> mkmdir all_chi2
    -> find . -name *.mat -exec cp -vf {} all_chi2/ \;

7. Generate PDF results and plots with 
    -> results_generation.m
